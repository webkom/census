import express
import request
import redis

r = redis.createClient()

router = express.Router()

router.get('/', (req, res) ->
    r.hgetall('servers', (err, redisRes) ->
        servers = []
        redisRes = redisRes or {}

        for server in Object.keys(redisRes)
            servers.push(JSON.parse(redisRes[server]))

        res.render('index', {
            servers: servers
        })
    )
)

export router
